{"ast":null,"code":"// src/store/slices/cartSlice.js\nimport { createSlice } from '@reduxjs/toolkit';\n\n// Отримуємо початковий стан з localStorage або використовуємо пустий масив\nconst loadCartFromStorage = () => {\n  try {\n    const savedCart = localStorage.getItem('cart');\n    return savedCart ? JSON.parse(savedCart) : {\n      items: [],\n      isLoading: false,\n      error: null\n    };\n  } catch (error) {\n    console.error('Failed to load cart from localStorage:', error);\n    return {\n      items: [],\n      isLoading: false,\n      error: null\n    };\n  }\n};\nconst initialState = loadCartFromStorage();\nconst cartSlice = createSlice({\n  name: 'cart',\n  initialState,\n  reducers: {\n    addItem: (state, action) => {\n      const {\n        _id,\n        name,\n        price,\n        image,\n        stock\n      } = action.payload;\n      const existingItem = state.items.find(item => item._id === _id);\n      if (existingItem) {\n        // Перевіряємо наявність товару перед збільшенням кількості\n        if (existingItem.quantity < stock) {\n          existingItem.quantity += 1;\n        }\n      } else {\n        state.items.push({\n          _id,\n          name,\n          price,\n          image,\n          stock,\n          quantity: 1\n        });\n      }\n      // Зберігаємо в localStorage\n      localStorage.setItem('cart', JSON.stringify(state));\n    },\n    removeItem: (state, action) => {\n      state.items = state.items.filter(item => item._id !== action.payload);\n      localStorage.setItem('cart', JSON.stringify(state));\n    },\n    updateQuantity: (state, action) => {\n      const {\n        productId,\n        quantity\n      } = action.payload;\n      const item = state.items.find(item => item._id === productId);\n      if (item && quantity > 0 && quantity <= item.stock) {\n        item.quantity = quantity;\n        localStorage.setItem('cart', JSON.stringify(state));\n      }\n    },\n    clearCart: state => {\n      state.items = [];\n      localStorage.removeItem('cart');\n    },\n    setLoading: (state, action) => {\n      state.isLoading = action.payload;\n    },\n    setError: (state, action) => {\n      state.error = action.payload;\n    }\n  }\n});\nexport const {\n  addItem,\n  removeItem,\n  updateQuantity,\n  clearCart,\n  setLoading,\n  setError\n} = cartSlice.actions;\n\n// Селектори\nexport const selectCartItems = state => state.cart.items;\nexport const selectCartTotal = state => state.cart.items.reduce((total, item) => total + item.price * item.quantity, 0);\nexport const selectCartItemsCount = state => state.cart.items.reduce((count, item) => count + item.quantity, 0);\n\n// Додаткові селектори\nexport const selectCartSubtotal = state => state.cart.items.reduce((total, item) => total + item.price * item.quantity, 0);\nexport const selectCartTax = state => selectCartSubtotal(state) * 0.1;\nexport const selectCartShipping = state => state.cart.items.length > 0 ? 9.99 : 0;\nexport const selectCartGrandTotal = state => selectCartSubtotal(state) + selectCartTax(state) + selectCartShipping(state);\nexport const selectIsCartEmpty = state => state.cart.items.length === 0;\nexport default cartSlice.reducer;","map":{"version":3,"names":["createSlice","loadCartFromStorage","savedCart","localStorage","getItem","JSON","parse","items","isLoading","error","console","initialState","cartSlice","name","reducers","addItem","state","action","_id","price","image","stock","payload","existingItem","find","item","quantity","push","setItem","stringify","removeItem","filter","updateQuantity","productId","clearCart","setLoading","setError","actions","selectCartItems","cart","selectCartTotal","reduce","total","selectCartItemsCount","count","selectCartSubtotal","selectCartTax","selectCartShipping","length","selectCartGrandTotal","selectIsCartEmpty","reducer"],"sources":["/Users/serhii_bondariev/Documents/GitHub/PowerTools/frontend/src/store/slices/cartSlice.js"],"sourcesContent":["// src/store/slices/cartSlice.js\nimport { createSlice } from '@reduxjs/toolkit';\n\n// Отримуємо початковий стан з localStorage або використовуємо пустий масив\nconst loadCartFromStorage = () => {\n  try {\n    const savedCart = localStorage.getItem('cart');\n    return savedCart ? JSON.parse(savedCart) : { items: [], isLoading: false, error: null };\n  } catch (error) {\n    console.error('Failed to load cart from localStorage:', error);\n    return { items: [], isLoading: false, error: null };\n  }\n};\n\nconst initialState = loadCartFromStorage();\n\nconst cartSlice = createSlice({\n  name: 'cart',\n  initialState,\n  reducers: {\n    addItem: (state, action) => {\n      const { _id, name, price, image, stock } = action.payload;\n      const existingItem = state.items.find((item) => item._id === _id);\n\n      if (existingItem) {\n        // Перевіряємо наявність товару перед збільшенням кількості\n        if (existingItem.quantity < stock) {\n          existingItem.quantity += 1;\n        }\n      } else {\n        state.items.push({\n          _id,\n          name,\n          price,\n          image,\n          stock,\n          quantity: 1,\n        });\n      }\n      // Зберігаємо в localStorage\n      localStorage.setItem('cart', JSON.stringify(state));\n    },\n\n    removeItem: (state, action) => {\n      state.items = state.items.filter((item) => item._id !== action.payload);\n      localStorage.setItem('cart', JSON.stringify(state));\n    },\n\n    updateQuantity: (state, action) => {\n      const { productId, quantity } = action.payload;\n      const item = state.items.find((item) => item._id === productId);\n      if (item && quantity > 0 && quantity <= item.stock) {\n        item.quantity = quantity;\n        localStorage.setItem('cart', JSON.stringify(state));\n      }\n    },\n\n    clearCart: (state) => {\n      state.items = [];\n      localStorage.removeItem('cart');\n    },\n\n    setLoading: (state, action) => {\n      state.isLoading = action.payload;\n    },\n\n    setError: (state, action) => {\n      state.error = action.payload;\n    },\n  },\n});\n\nexport const { addItem, removeItem, updateQuantity, clearCart, setLoading, setError } =\n  cartSlice.actions;\n\n// Селектори\nexport const selectCartItems = (state) => state.cart.items;\n\nexport const selectCartTotal = (state) =>\n  state.cart.items.reduce((total, item) => total + item.price * item.quantity, 0);\n\nexport const selectCartItemsCount = (state) =>\n  state.cart.items.reduce((count, item) => count + item.quantity, 0);\n\n// Додаткові селектори\nexport const selectCartSubtotal = (state) =>\n  state.cart.items.reduce((total, item) => total + item.price * item.quantity, 0);\n\nexport const selectCartTax = (state) => selectCartSubtotal(state) * 0.1;\n\nexport const selectCartShipping = (state) => (state.cart.items.length > 0 ? 9.99 : 0);\n\nexport const selectCartGrandTotal = (state) =>\n  selectCartSubtotal(state) + selectCartTax(state) + selectCartShipping(state);\n\nexport const selectIsCartEmpty = (state) => state.cart.items.length === 0;\n\nexport default cartSlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}